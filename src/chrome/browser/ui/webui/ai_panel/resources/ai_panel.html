<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>AI Automation Panel</title>
  <link rel="stylesheet" href="ai_panel.css">
</head>
<body>
  <div class="panel-container">
    <!-- Header -->
    <header class="panel-header">
      <h1>AI Automation</h1>
      <button id="settings-btn" class="icon-btn" title="Settings">‚öôÔ∏è</button>
    </header>

    <!-- Settings Panel (hidden by default) -->
    <div id="settings-panel" class="settings-panel hidden">
      <h2>Settings</h2>
      
      <div class="setting-group">
        <label for="provider-select">AI Provider:</label>
        <select id="provider-select" class="provider-select">
          <option value="">Loading...</option>
        </select>
        <div id="provider-info" class="provider-info"></div>
      </div>

      <div id="api-key-section" class="setting-group hidden">
        <label for="api-key-input">API Key:</label>
        <div class="api-key-container">
          <input 
            type="password" 
            id="api-key-input" 
            placeholder="Enter API key..."
            class="api-key-input"
          >
          <button id="toggle-api-key" class="icon-btn" title="Show/Hide">üëÅÔ∏è</button>
        </div>
        <button id="save-api-key" class="btn btn-primary">Save API Key</button>
        <div id="api-key-status" class="status-message"></div>
      </div>

      <div class="setting-group">
        <button id="clear-history" class="btn">Clear Conversation History</button>
      </div>

      <button id="close-settings" class="btn">Close</button>
    </div>

    <!-- Main Panel -->
    <div id="main-panel" class="main-panel">
      <!-- Status Bar -->
      <div class="status-bar">
        <div class="status-indicator">
          <span id="provider-status" class="status-badge">Not configured</span>
          <span id="automation-status" class="status-badge">Ready</span>
        </div>
      </div>

      <!-- Request Input -->
      <div class="request-section">
        <label for="user-request">What would you like to automate?</label>
        <textarea 
          id="user-request" 
          placeholder="Example: Open Notepad and type 'Hello World'&#10;Example: Search for 'Chromium' in File Explorer&#10;Example: Open calculator and calculate 25 * 16"
          rows="4"
        ></textarea>
        
        <div class="request-actions">
          <button id="execute-btn" class="btn btn-primary" disabled>
            Execute Automation
          </button>
          <button id="capture-screen-btn" class="btn">
            Preview Screen
          </button>
        </div>
      </div>

      <!-- Preview Section -->
      <div id="preview-section" class="preview-section hidden">
        <h3>Screen Preview</h3>
        <div id="screenshot-preview" class="screenshot-preview">
          <p class="placeholder-text">Click "Preview Screen" to capture current desktop</p>
        </div>
        <div id="ui-tree-preview" class="ui-tree-preview">
          <details>
            <summary>UI Tree (Click to expand)</summary>
            <pre id="ui-tree-content">No UI tree captured yet</pre>
          </details>
        </div>
      </div>

      <!-- Actions Section -->
      <div id="actions-section" class="actions-section hidden">
        <h3>Planned Actions</h3>
        <div id="actions-list" class="actions-list"></div>
        <div class="actions-controls">
          <button id="confirm-actions-btn" class="btn btn-success">
            Confirm & Execute
          </button>
          <button id="cancel-actions-btn" class="btn">
            Cancel
          </button>
        </div>
      </div>

      <!-- Execution Log -->
      <div class="execution-log">
        <h3>Execution Log</h3>
        <div id="log-output" class="log-output">
          <p class="log-entry info">Ready to automate. Configure an AI provider to begin.</p>
        </div>
        <button id="clear-log" class="btn btn-small">Clear Log</button>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="native_messaging_helper.js"></script>
  <script src="ai_provider_manager.js"></script>
  <script src="ai_panel.js"></script>
</body>
</html>
